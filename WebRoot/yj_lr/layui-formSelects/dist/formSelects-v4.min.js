"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e,t,n){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else if(t.layui&&e.define){e.define(["jquery"],function(e){e("formSelects",n())})}else{t.formSelects=n()}})(typeof layui=="undefined"?null:layui,window,function(){var t="4.0.0.0704",D="xm-select",H="xm-select-parent",E="xm-select-input",M="xm-select--suffix",m="xm-select-this",O="xm-select-label",F="xm-select-search",P="xm-select-search-type",N="xm-select-show-count",I="xm-select-create",c="xm-select-create-long",_="xm-select-max",V="xm-select-skin",z="xm-select-direction",U="xm-select-height",y="xm-dis-disabled",X="xm-select-dis",u="xm-select-temp",B="xm-select-radio",g="xm-select-linkage",Y="xm-select-dl",h="xm-select-hide",W="xm-hide-input",q="xm-select-sj",e="xm-icon-close",J="xm-select-title",Q="xm-form-select",d="xm-form-selected",v="xm-select-none",x="xm-select-empty",R="xm-input",Z="xm-dl-input",b="xm-select-tips",r="xm-icon-yes",k="xm-cz",l="xm-cz-group",$="请选择",G={},w={on:{},filter:{},maxTips:{}},K={type:"get",header:{},first:true,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,clearInput:false},n=[{icon:"iconfont icon-quanxuan",name:"全选",click:function e(t,n){n.selectAll(t,true,true)}},{icon:"iconfont icon-qingkong",name:"清空",click:function e(t,n){n.removeAll(t,true,true)}},{icon:"iconfont icon-fanxuan",name:"反选",click:function e(t,n){n.reverse(t,true,true)}},{icon:"iconfont icon-pifu",name:"换肤",click:function e(t,n){n.skin(t)}}],ee=window.$||window.layui&&window.layui.jquery,o=ee(window),te={},ne=function e(t){var r=this;this.config={name:null,max:null,maxTips:function e(t,n,i){var a=ee('[xid="'+r.config.name+'"]').prev().find("."+D);if(a.parents(".layui-form-item[pane]").length){a=a.parents(".layui-form-item[pane]")}a.attr("style","border-color: red !important");setTimeout(function(){a.removeAttr("style")},300)},init:null,on:null,filter:function e(t,n,i,a){return i.name.indexOf(n)==-1},clearid:-1,direction:"auto",height:null,isEmpty:false,btns:[n[0],n[1],n[2]],searchType:0,create:function e(t,n){return Date.now()},template:function e(t,n,i,a){return t},showCount:0,isCreate:false,placeholder:$};this.select=null;this.values=[];ee.extend(true,this.config,t)};var i=function e(){this.appender();this.init();this.on();this.initVal();this.onreset()};i.prototype.appender=function(){if(!Array.prototype.map){Array.prototype.map=function(e,t){var n,i,a,r=Object(this),l=r.length>>>0;if(t){n=t}i=new Array(l);a=0;while(a<l){var o,s;if(a in r){o=r[a];s=e.call(n,o,a,r);i[a]=s}a++}return i}}if(!Array.prototype.forEach){Array.prototype.forEach=function e(t,n){var i,a;if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var l=r.length>>>0;if(typeof t!=="function"){throw new TypeError(t+" is not a function")}if(arguments.length>1){i=n}a=0;while(a<l){var o;if(a in r){o=r[a];t.call(i,o,a,r)}a++}}}(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=e}else{e(ee)}}})(function(u){var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],p=Array.prototype.slice,h,v;if(u.event.fixHooks){for(var t=e.length;t;){u.event.fixHooks[e[--t]]=u.event.mouseHooks}}var m=u.event.special.mousewheel={version:"3.1.12",setup:function e(){if(this.addEventListener){for(var t=n.length;t;){this.addEventListener(n[--t],i,false)}}else{this.onmousewheel=i}u.data(this,"mousewheel-line-height",m.getLineHeight(this));u.data(this,"mousewheel-page-height",m.getPageHeight(this))},teardown:function e(){if(this.removeEventListener){for(var t=n.length;t;){this.removeEventListener(n[--t],i,false)}}else{this.onmousewheel=null}u.removeData(this,"mousewheel-line-height");u.removeData(this,"mousewheel-page-height")},getLineHeight:function e(t){var n=u(t),i=n["offsetParent"in u.fn?"offsetParent":"parent"]();if(!i.length){i=u("body")}return parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function e(t){return u(t).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};u.fn.extend({mousewheel:function e(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function e(t){return this.unbind("mousewheel",t)}});function i(e){var t=e||window.event,n=p.call(arguments,1),i=0,a=0,r=0,l=0,o=0,s=0;e=u.event.fix(t);e.type="mousewheel";if("detail"in t){r=t.detail*-1}if("wheelDelta"in t){r=t.wheelDelta}if("wheelDeltaY"in t){r=t.wheelDeltaY}if("wheelDeltaX"in t){a=t.wheelDeltaX*-1}if("axis"in t&&t.axis===t.HORIZONTAL_AXIS){a=r*-1;r=0}i=r===0?a:r;if("deltaY"in t){r=t.deltaY*-1;i=r}if("deltaX"in t){a=t.deltaX;if(r===0){i=a*-1}}if(r===0&&a===0){return}if(t.deltaMode===1){var c=u.data(this,"mousewheel-line-height");i*=c;r*=c;a*=c}else{if(t.deltaMode===2){var f=u.data(this,"mousewheel-page-height");i*=f;r*=f;a*=f}}l=Math.max(Math.abs(r),Math.abs(a));if(!v||l<v){v=l;if(g(t,l)){v/=40}}if(g(t,l)){i/=40;a/=40;r/=40}i=Math[i>=1?"floor":"ceil"](i/v);a=Math[a>=1?"floor":"ceil"](a/v);r=Math[r>=1?"floor":"ceil"](r/v);if(m.settings.normalizeOffset&&this.getBoundingClientRect){var d=this.getBoundingClientRect();o=e.clientX-d.left;s=e.clientY-d.top}e.deltaX=a;e.deltaY=r;e.deltaFactor=v;e.offsetX=o;e.offsetY=s;e.deltaMode=0;n.unshift(e,i,a,r);if(h){clearTimeout(h)}h=setTimeout(y,200);return(u.event.dispatch||u.event.handle).apply(this,n)}function y(){v=null}function g(e,t){return m.settings.adjustOldDeltas&&e.type==="mousewheel"&&t%120===0}})};i.prototype.init=function(e){var A=this;ee(e?e:"select["+D+"]").each(function(e,t){var n=ee(t),i=n.attr(D),a=n.next(".layui-form-select"),r=t.disabled,l=n.attr(_)-0,o=n.attr(F)!=undefined,s=o?n.attr(F):null,c=n.attr(I)!=undefined,f=n.attr(B)!=undefined,d=n.attr(V),u=n.attr(z),p=t.options[0],h=n.attr(U),v=n.attr("name"),m=n.attr("lay-verify"),y=n.attr("lay-verType"),g=n.attr(P)=="dl"?1:0,x=n.attr(N)-0,b=p?p.value?$:p.innerHTML||$:$,k=n.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,val:e.value}}),w=new ne;if(isNaN(x)||x<=0){x=19921012}var C=G[i];G[i]=w;w.values=k;w.config.init=k.concat([]);w.config.name=i;w.config.disabled=r;w.config.max=l;w.config.isSearch=o;w.config.searchUrl=s;w.config.isCreate=c;w.config.radio=f;w.config.skin=d;w.config.direction=u;w.config.height=h;w.config.searchType=g;w.config.formname=v;w.config.layverify=m;w.config.layverType=y;w.config.searchType=g;w.config.showCount=x;w.config.placeholder=b;if(C){ee.extend(true,w.config,C.config);r=w.config.disabled;o=w.config.isSearch;s=w.config.searchUrl;d=w.config.skin;h=w.config.height;l=w.config.max;v=w.config.formname;m=w.config.layverify;y=w.config.layverType;b=w.config.placeholder;f=w.config.radio;if(C.config.init){w.values=C.config.init.map(function(e){if((typeof e==="undefined"?"undefined":_typeof(e))=="object"){return e}return{name:n.find('option[value="'+e+'"]').text(),val:e}}).filter(function(e){return e.name});w.config.init=w.values.concat([])}}a[0]&&a.remove();var S=A.renderSelect(i,b,t);var T=!h||h=="auto"?"":'xm-hg style="height: 34px;"';var L=['<div class="'+O+'">','<input type="text" fsw class="'+R+" "+E+'" '+(o?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"];var j=ee('<div class="'+Q+'" '+V+'="'+d+'">\n\t\t\t\t\t<input class="'+W+'" value="" name="'+v+'" lay-verify="'+m+'" lay-verType="'+y+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+J+" "+(r?X:"")+'">\n\t\t\t\t\t\t<div class="'+R+" "+D+'" '+T+">\n\t\t\t\t\t\t\t"+L.join("")+'\n\t\t\t\t\t\t\t<i class="'+q+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+M+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+b+'" readonly="readonly" unselectable="on" class="'+R+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+i+'" class="'+Y+" "+(f?B:"")+'">'+S+"</dl>\n\t\t\t\t</div>");if(C){ee('dl[xid="'+i+'"]').parents("."+H).html(j);w.select=n}else{n.wrap('<div class="'+H+'" FS_ID="'+i+'"></div>');n.after(j);w.select=n.remove()}if(o){te[i]=ee.extend(true,{},K,{searchUrl:s});ee(document).on("input","div."+H+'[FS_ID="'+i+'"] .'+E,function(e){A.search(i,e,s)});if(s){A.triggerSearch(j,true)}}else{j.find("dl dd."+Z).css("display","none")}})};i.prototype.search=function(a,e,t,n){var i=this;var r=void 0;if(n){r=n}else{r=e.target;var l=e.keyCode;if(l===9||l===13||l===37||l===38||l===39||l===40){return false}}var o=ee.trim(r.value);this.changePlaceHolder(ee(r));var s=te[a]?te[a]:K;t=s.searchUrl||t;var c=G[a],f=c.config.isCreate,d=ee('dl[xid="'+a+'"]').parents("."+Q);if(t){if(s.searchVal){o=s.searchVal;s.searchVal=""}if(!s.beforeSearch||s.beforeSearch&&s.beforeSearch instanceof Function&&s.beforeSearch(a,t,o)){var u=s.delay;if(s.first){s.first=false;u=10}clearTimeout(c.clearid);c.clearid=setTimeout(function(){d.find("dl > *:not(."+b+")").remove();d.find("dd."+v).addClass(x).text("请求中");i.ajax(a,t,o,false,null,true)},u)}}else{d.find("dl ."+h).removeClass(h);d.find("dl dd:not(."+b+")").each(function(e,t){var n=ee(t);var i=G[a].config.filter||w.filter[a];if(i&&i(a,o,{name:n.find("span").attr("name"),val:n.attr("lay-value")},n.hasClass(y))==true){n.addClass(h)}});d.find("dl dt").each(function(e,t){if(!ee(t).nextUntil("dt",":not(."+h+")").length){ee(t).addClass(h)}});this.create(a,f,o);var p=d.find("dl dd:not(."+b+"):not(."+h+")");if(!p.length){d.find("dd."+v).addClass(x).text("无匹配项")}else{d.find("dd."+v).removeClass(x)}}};i.prototype.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"};i.prototype.triggerSearch=function(e,i){var a=this;(e?[e]:ee("."+Q).toArray()).forEach(function(e,t){e=ee(e);var n=e.find("dl").attr("xid");if(n&&G[n]&&G[n].config.isEmpty||i){a.search(n,null,null,G[n].config.searchType==0?e.find("."+O+" ."+E):e.find("dl ."+Z+" ."+E))}})};i.prototype.clearInput=function(e){var t=ee("."+H+'[fs_id="'+e+'"]');var n=G[e].config.searchType==0?t.find("."+O+" ."+E):t.find("dl ."+Z+" ."+E);n.val("")};i.prototype.ajax=function(n,i,a,r,l,o){var s=this;var c=ee("."+H+' dl[xid="'+n+'"]').parents("."+Q);if(!c[0]||!i){return}var f=te[n]?te[n]:K;var e=ee.extend(true,{},f.data);e[f.searchName]=a;ee.ajax({type:f.type,headers:f.header,url:i,data:f.dataType=="json"?JSON.stringify(e):e,success:function e(t){if(typeof t=="string"){t=JSON.parse(t)}f.beforeSuccess&&f.beforeSuccess instanceof Function&&(t=f.beforeSuccess(n,i,a,t));if(s.isArray(t)){t={code:0,msg:"",data:t}}if(t.code!=0){c.find("dd."+v).addClass(x).text(t.msg)}else{c.find("dd."+v).removeClass(x);s.renderData(n,t.data,r,l,o);G[n].config.isEmpty=t.data.length==0}f.success&&f.success instanceof Function&&f.success(n,i,a,t)},error:function e(t){c.find("dd[lay-value]:not(."+b+")").remove();c.find("dd."+v).addClass(x).text("服务异常");f.error&&f.error instanceof Function&&f.error(n,i,a,t)}})};i.prototype.renderData=function(r,s,e,c,t){var n=this;if(e){var i=function(){var n=[],i=0,l={0:s},o=te[r]?te[r]:K;var e=function e(){var r=n[i++]=[],t=l;l={};ee.each(t,function(a,e){ee.each(e,function(e,t){var n={pid:a,name:t[o.keyName],val:t[o.keyVal]};r.push(n);var i=t[o.keyChildren];if(i&&i.length){l[n.val]=i}})})};do{e()}while(Object.getOwnPropertyNames(l).length);var t=ee("."+H+' dl[xid="'+r+'"]').parents("."+Q);var a=['<div class="xm-select-linkage">'];ee.each(n,function(e,t){var i=['<div style="left: '+(c-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(e!=0?"xm-select-linkage-hide":"")+'">'];ee.each(t,function(e,t){var n='<li title="'+t.name+'" pid="'+t.pid+'" value="'+t.val+'"><span>'+t.name+"</span></li>";i.push(n)});i.push("</div>");a=a.concat(i)});a.push('<div style="clear: both; height: 288px;"></div>');a.push("</div>");t.find("dl").html(a.join(""));t.find("."+E).css("display","none");return{v:void 0}}();if((typeof i==="undefined"?"undefined":_typeof(i))==="object")return i.v}var a=ee("."+H+' dl[xid="'+r+'"]').parents("."+Q);var l=te[r]?te[r]:K;var o=a.find("."+M+" input");var f=[];a.find("dl").html(this.renderSelect(r,o.attr("placeholder")||o.attr("back"),s.map(function(e){if(e[l.keySel]){f.push({name:e[l.keyName],val:e[l.keyVal]})}return{innerHTML:e[l.keyName],value:e[l.keyVal],sel:e[l.keySel],disabled:e[l.keyDis],type:e.type,name:e.name}})));var d=a.find("."+O);var u=a.find("dl[xid]");if(t){var p=G[r].values;p.forEach(function(e,t){u.find('dd[lay-value="'+e.val+'"]').addClass(m)});f.forEach(function(e,t){if(n.indexOf(p,e)==-1){n.addLabel(r,d,e);u.find('dd[lay-value="'+e.val+'"]').addClass(m);p.push(e)}})}else{f.forEach(function(e,t){n.addLabel(r,d,e);u.find('dd[lay-value="'+e.val+'"]').addClass(m)});G[r].values=f}this.commonHanler(r,d)};i.prototype.create=function(e,t,n){if(t&&n){var i=G[e],a=ee('[xid="'+e+'"]'),r=a.find("dd."+b+"."+Z),l=null,o=a.find("dd."+u);a.find("dd:not(."+b+"):not(."+u+")").each(function(e,t){if(n==ee(t).find("span").attr("name")){l=t}});if(!l){var s=i.config.create(e,name);if(o[0]){o.attr("lay-value",s);o.find("span").text(n);o.removeClass(h)}else{r.after(ee(this.createDD(e,{innerHTML:n,value:s},u+" "+c)))}}}else{ee("[xid="+e+"] dd."+u).remove()}};i.prototype.createDD=function(e,t,n){var i=ee.trim(t.innerHTML);var a=G[e].config.template(i,t.value,t.selected,t.disabled);return'<dd lay-value="'+t.value+'" class="'+(t.disabled?y:"")+" "+(n?n:"")+'">\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?y:"")+'">\n\t\t\t\t\t\t<i class="'+r+'"></i>\n\t\t\t\t\t\t<span name="'+i+'">'+a+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"};i.prototype.createQuickBtn=function(e,t){return'<div class="'+k+'" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"};i.prototype.renderBtns=function(e,t,n){var i=this;var a=[];var r=ee('dl[xid="'+e+'"]');a.push('<div class="'+l+'" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">');ee.each(G[e].config.btns,function(e,t){a.push(i.createQuickBtn(t,n))});a.push("</div>");a.push(this.createQuickBtn({icon:"iconfont icon-caidan",name:""}));return a.join("")};i.prototype.renderSelect=function(n,e,t){var i=this;var a=[];if(G[n].config.btns.length){setTimeout(function(){var e=ee('dl[xid="'+n+'"]');e.parents("."+Q).attr(P,G[n].config.searchType);e.find("."+l).css("max-width",e.prev().width()-54+"px")},10);a.push(['<dd lay-value="" class="'+b+'" style="background-color: #FFF!important;">',this.renderBtns(n,null,"30px"),"</dd>",'<dd lay-value="" class="'+b+" "+Z+'" style="background-color: #FFF!important;">','<i class="iconfont icon-sousuo"></i>','<input type="text" class="'+R+" "+E+'" placeholder="请搜索"/>',"</dd>"].join(""))}else{a.push('<dd lay-value="" class="'+b+'">'+e+"</dd>")}if(this.isArray(t)){ee(t).each(function(e,t){if(t){if(t.type&&t.type==="optgroup"){a.push("<dt>"+t.name+"</dt>")}else{a.push(i.createDD(n,t))}}})}else{ee(t).find("*").each(function(e,t){if(t.tagName.toLowerCase()=="option"&&e==0&&!t.value){return}if(t.tagName.toLowerCase()==="optgroup"){a.push("<dt>"+t.label+"</dt>")}else{a.push(i.createDD(n,t))}})}a.push('<dt style="display:none;"> </dt>');a.push('<dd class="'+b+" "+v+" "+(a.length===2?x:"")+'">没有选项</dd>');return a.join("")};i.prototype.on=function(){var i=this;this.one();ee(document).on("click",function(e){if(!ee(e.target).parents("."+J)[0]){ee("."+H+" dl ."+h).removeClass(h);ee("."+H+" dl dd."+x).removeClass(x);ee("."+H+" dl dd."+u).remove();ee.each(G,function(e,t){i.clearInput(e);if(!t.values.length){i.changePlaceHolder(ee('div[FS_ID="'+e+'"] .'+O))}})}ee("."+H+" ."+d).removeClass(d)});ee(document).on("mousewheel",".xm-select-label",function(e,t){var n=ee(e.target);i.calcLabelLeft(n.is("."+O)?n:n.parents("."+O),t)});ee(document).on("mouseover",".xm-select-label",function(){var e=ee(document).scrollTop();ee(document).bind("scroll",function(){ee(document).scrollTop(e)})});ee(document).on("mouseout",".xm-select-label",function(){ee(document).unbind("scroll")})};i.prototype.scroll=function(e){ee(window).scroll(function(){ee(window).scrollTop(e)})};i.prototype.calcLabelLeft=function(e,t,n){var i=this.getPosition(e[0]);i.y=i.x+e[0].clientWidth;var a=e[0].offsetLeft;if(!e.find("span").length){a=0}else if(n){var r=e.find("span:last");r.css("display")=="none"?r=r.prev()[0]:r=r[0];var l=this.getPosition(r);l.y=l.x+r.clientWidth;if(l.y>i.y){a=a-(l.y-i.y)-5}else{a=0}}else{if(t<0){var o=e.find(":last");o.css("display")=="none"?o=o.prev()[0]:o=o[0];var s=this.getPosition(o);s.y=s.x+o.clientWidth;if(s.y>i.y){a-=10}}else{if(a<0){a+=10}if(a>0){a=0}}}e.css("left",a+"px")};i.prototype.one=function(e){var v=this;ee(e?e:document).find("."+J).on("click",function(e){var t=ee(e.target),n=t.is(J)?t:t.parents("."+J),i=n.next(),a=i.attr("xid");ee("dl[xid]").not(i).each(function(e,t){v.clearInput(ee(t).attr("xid"))});ee("dl[xid]").not(i).find("dd."+h).removeClass(h);if(n.hasClass(X)){return false}if(t.is("."+q)||t.is("."+E+"[readonly]")){v.changeShow(n,!n.parents("."+Q).hasClass(d));return false}if(n.find("."+E+":not(readonly)")[0]){var r=n.find("."+E),l={x:e.pageX,y:e.pageY},o=v.getPosition(n[0]),s=n.width();while(l.x>o.x){if(ee(document.elementFromPoint(l.x,l.y)).is(r)){r.focus();v.changeShow(n,true);return false}l.x-=50}}if(t.is("."+E)){v.changeShow(n,true);return false}if(t.is('i[fsw="'+D+'"]')){var c={name:t.prev().text(),val:t.parent().attr("value")},f=i.find("dd[lay-value='"+c.val+"']");if(f.hasClass(y)){return false}v.handlerLabel(a,f,false,c);return false}v.changeShow(n,!n.parents("."+Q).hasClass(d));return false});ee(e?e:document).find("dl."+Y).off("click").on("click",function(e){var t=ee(e.target);if(t.is("."+g)||t.parents("."+g)[0]){t=t.is("li")?t:t.parents("li");var n=t.parents(".xm-select-linkage-group"),i=t.parents("dl").attr("xid");n.find(".xm-select-active").removeClass("xm-select-active");t.addClass("xm-select-active");n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var a=n.next(".xm-select-linkage-group");a.find("li").addClass("xm-select-linkage-hide");a.find('li[pid="'+t.attr("value")+'"]').removeClass("xm-select-linkage-hide");if(!a[0]||a.find("li:not(.xm-select-linkage-hide)").length==0){var r=[],l=0,o=!t.hasClass("xm-select-this");if(G[i].config.radio){t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this")}do{r[l++]={name:t.find("span").text(),val:t.attr("value")};t=t.parents(".xm-select-linkage-group").prev().find('li[value="'+t.attr("pid")+'"]')}while(t.length);r.reverse();var s={name:r.map(function(e){return e.name}).join("/"),val:r.map(function(e){return e.val}).join("/")};v.handlerLabel(i,null,o,s)}else{a.removeClass("xm-select-linkage-hide")}return false}if(t.is("dl")){return false}if(t.is("dt")){t.nextUntil("dt").each(function(e,t){t=ee(t);if(t.hasClass(y)||t.hasClass(m)){}else{t.click()}});return false}var c=t.is("dd")?t:t.parents("dd");var f=c.parent("dl").attr("xid");if(c.hasClass(y)){return false}if(c.hasClass(b)){var d=t.is("."+k)?t:t.parents("."+k);if(!d[0]){return false}var u=d.attr("method");var p=G[f].config.btns.filter(function(e){return e.name==u})[0];p&&p.click&&p.click instanceof Function&&p.click(f,v);return false}var h=!c.hasClass(m);v.handlerLabel(f,c,h);return false})};i.prototype.linkageAdd=function(e,t){var n=ee('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var i=t.val.split("/");var a=void 0,r=void 0,l=0;var o=[];do{a=i[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+a+'"]');r[0]&&o.push(r);l++}while(r.length&&a!=undefined);if(o.length==i.length){ee.each(o,function(e,t){t.addClass("xm-select-this")})}};i.prototype.linkageDel=function(e,t){var n=ee('dl[xid="'+e+'"]');var i=t.val.split("/");var a=void 0,r=void 0,l=i.length-1;do{a=i[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+a+'"]');if(!r.parent().next().find("li[pid="+a+"].xm-select-this").length){r.removeClass("xm-select-this")}l--}while(r.length&&a!=undefined)};i.prototype.valToName=function(e,t){var i=ee('dl[xid="'+e+'"]');var n=(t+"").split("/");var a=[];ee.each(n,function(e,t){var n=i.find(".xm-select-linkage-group"+(e+1)+' li[value="'+t+'"] span').text();a.push(n)});return a.length==n.length?a.join("/"):null};i.prototype.commonHanler=function(e,t){this.changePlaceHolder(t);this.retop(t.parents("."+Q));this.checkHideSpan(e,t);this.calcLabelLeft(t,0,true);t.parents("."+H).find("."+W).val(G[e].values.map(function(e){return e.val}).join(","));t.parents("."+J+" ."+D).attr("title",G[e].values.map(function(e){return e.name}).join(","))};i.prototype.initVal=function(e){var o=this;var t={};if(e){t[e]=G[e]}else{t=G}ee.each(t,function(n,e){var t=e.values,i=ee('dl[xid="'+n+'"]').parent(),a=i.find("."+O),r=i.find("dl");r.find("dd."+m).removeClass(m);var l=t.concat([]);l.concat([]).forEach(function(e,t){o.addLabel(n,a,e);r.find('dd[lay-value="'+e.val+'"]').addClass(m)});if(e.config.radio){l.length&&t.push(l[l.length-1])}o.commonHanler(n,a)})};i.prototype.handlerLabel=function(e,t,n,i,a){var r=ee('[xid="'+e+'"]').prev().find("."+O),l=t&&{name:t.find("span").attr("name"),val:t.attr("lay-value")},o=G[e].values,s=G[e].config.on||w.on[e];if(i){l=i}var c=G[e];if(n&&c.config.max&&c.values.length>=c.config.max){var f=G[e].config.maxTips||w.maxTips[e];f&&f(e,o.concat([]),l,c.max);return}if(!a){if(s&&s instanceof Function&&s(e,o.concat([]),l,n,t&&t.hasClass(y))==false){return}}var d=ee('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(m),t.removeClass(u)):d.find(".xm-select-linkage")[0]&&this.linkageAdd(e,l),this.addLabel(e,r,l),o.push(l)):(t&&t[0]?t.removeClass(m):d.find(".xm-select-linkage")[0]&&this.linkageDel(e,l),this.delLabel(e,r,l),this.remove(o,l));if(!r[0])return;if(c.config.radio){this.changeShow(r,false)}r.parents("."+J).prev().removeClass("layui-form-danger");c.config.clearInput&&this.clearInput(e);this.commonHanler(e,r)};i.prototype.addLabel=function(e,t,n){if(!n)return;var i='fsw="'+D+'"';var a=[ee("<span "+i+' value="'+n.val+'"><font '+i+">"+n.name+"</font></span>"),ee("<i "+i+' class="xm-icon-close">×</i>')],r=a[0],l=a[1];r.append(l);var o=G[e];if(o.config.radio){o.values.length=0;ee('dl[xid="'+e+'"]').find("dd."+m+':not([lay-value="'+n.val+'"])').removeClass(m);t.find("span").remove()}t.find("input").css("width","50px");t.find("input").before(r)};i.prototype.delLabel=function(e,t,n){if(!n)return;t.find('span[value="'+n.val+'"]:first').remove()};i.prototype.checkHideSpan=function(e,t){var n=t.parents("."+D)[0].offsetHeight+5;t.find("span.xm-span-hide").removeClass("xm-span-hide");t.find("span[style]").remove();var i=G[e].config.showCount;t.find("span").each(function(e,t){if(e>=i){ee(t).addClass("xm-span-hide")}});var a=t.find("span:eq("+i+")");a[0]&&a.before(ee('<span style="padding-right: 6px;" fsw="'+D+'"> + '+(t.find("span").length-i)+"</span>"))};i.prototype.retop=function(e){var t=e.find("dl"),n=e.offset().top+e.outerHeight()+5-o.scrollTop(),i=t.outerHeight();var a=e.hasClass("layui-form-selectup")||t.css("top").indexOf("-")!=-1||n+i>o.height()&&n>=i;e=e.find("."+D);var r=G[t.attr("xid")];var l=t.parents(".layui-form-pane")[0]&&t.prev()[0].clientHeight>38?14:10;if(r){if(r.config.direction=="up"){t.css({top:"auto",bottom:"42px"});return}if(r.direction=="down"){t.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"});return}}if(a){t.css({top:"auto",bottom:"42px"})}else{t.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"})}};i.prototype.changeShow=function(e,t){ee(".layui-form-selected").removeClass("layui-form-selected");var n=e.parents("."+Q);ee("."+H+" ."+Q).not(n).removeClass(d);if(t){this.retop(n);n.addClass(d);n.find("."+E).focus();if(!n.find("dl dd[lay-value]:not(."+b+")").length){n.find("dl ."+v).addClass(x)}}else{var i=n.find("dl").attr("xid");n.removeClass(d);this.clearInput(i);n.find("dl ."+x).removeClass(x);n.find("dl dd."+h).removeClass(h);n.find("dl dd."+u).remove();if(i&&G[i]&&G[i].config.isEmpty){this.triggerSearch(n)}this.changePlaceHolder(n.find("."+O))}};i.prototype.changePlaceHolder=function(e){var t=e.parents("."+J);t[0]||(t=e.parents("dl").prev());if(!t[0]){return}var n=e.parents("."+H).find("dl[xid]").attr("xid");if(G[n]&&G[n].config.height){}else{var i=t.find("."+D)[0].clientHeight;t.css("height",(i>34?i+4:i)+"px");var a=t.parents("."+H).parent().prev();if(a.is(".layui-form-label")&&t.parents(".layui-form-pane")[0]){i=i>36?i+4:i;t.css("height",i+"px");a.css({height:i+2+"px",lineHeight:i-18+"px"})}}var r=t.find("."+M+" input"),l=!e.find("span:last")[0]&&!t.find("."+E).val();if(l){var o=r.attr("back");r.removeAttr("back");r.attr("placeholder",o)}else{var s=r.attr("placeholder");r.removeAttr("placeholder");r.attr("back",s)}};i.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++){if(e[n].val==t||e[n].val==(t?t.val:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t)){return n}}return-1};i.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.val:t);if(n>-1){e.splice(n,1);return true}return false};i.prototype.selectAll=function(i,a,e){var r=this;var l=ee('[xid="'+i+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){return}l.find("dd[lay-value]:not(."+b+"):not(."+m+")"+(e?":not(."+y+")":"")).each(function(e,t){t=ee(t);var n={name:t.find("span").attr("name"),val:t.attr("lay-value")};r.handlerLabel(i,l.find('dd[lay-value="'+n.val+'"]'),true,n,!a)})};i.prototype.removeAll=function(n,i,a){var r=this;var l=ee('[xid="'+n+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){G[n].values.concat([]).forEach(function(e,t){var n=e.val.split("/");var i=void 0,a=void 0,r=0;do{i=n[r++];a=l.find(".xm-select-linkage-group"+r+':not(.xm-select-linkage-hide) li[value="'+i+'"]');a.click()}while(a.length&&i!=undefined)});return}G[n].values.concat([]).forEach(function(e,t){if(a&&l.find('dd[lay-value="'+e.val+'"]').hasClass(y)){}else{r.handlerLabel(n,l.find('dd[lay-value="'+e.val+'"]'),false,e,!i)}})};i.prototype.reverse=function(i,a,e){var r=this;var l=ee('[xid="'+i+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){return}l.find("dd[lay-value]:not(."+b+")"+(e?":not(."+y+")":"")).each(function(e,t){t=ee(t);var n={name:t.find("span").attr("name"),val:t.attr("lay-value")};r.handlerLabel(i,l.find('dd[lay-value="'+n.val+'"]'),!t.hasClass(m),n,!a)})};i.prototype.skin=function(e){var t=["default","primary","normal","warm","danger"];var n=t[Math.floor(Math.random()*t.length)];ee('dl[xid="'+e+'"]').parents("."+H).find("."+Q).attr("xm-select-skin",n);this.check(e)&&this.commonHanler(e,ee('dl[xid="'+e+'"]').parents("."+H).find("."+O))};i.prototype.getPosition=function(e){var t=0,n=0;while(e!=null){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{x:t,y:n}};i.prototype.onreset=function(){ee(document).on("click","[type=reset]",function(e){ee(e.target).parents("form").find("."+H+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),i=ee(t),a=void 0,r={};f.removeAll(n);G[n].config.init.forEach(function(e,t){if(e&&(!r[e]||G[n].config.repeat)&&(a=i.find('dd[lay-value="'+e.val+'"]'))[0]){f.handlerLabel(n,a,true);r[e]=1}})})})};i.prototype.bindEvent=function(n,e,i){if(e&&e instanceof Function){i=e;e=null}if(i&&i instanceof Function){if(!e){ee.each(G,function(e,t){G[e]?G[e].config[n]=i:w[n][e]=i})}else{G[e]?G[e].config[n]=i:w[n][e]=i}}};i.prototype.check=function(e){if(ee('dl[xid="'+e+'"]').length){return true}else{delete G[e];return false}};i.prototype.render=function(e,t){if(this.check(e)){t=G[e].select}f.init(t);f.one(ee('dl[xid="'+e+'"]').parents("."+H));f.initVal(e)};var a=function e(){this.v=t};var f=new i;a.prototype.value=function(i,e,t){if(typeof i!="string"){return[]}var a=G[i];if(!f.check(i)){return[]}if(typeof e=="string"||e==undefined){var n=a.values.concat([])||[];if(e=="val"){return n.map(function(e){return e.val})}if(e=="valStr"){return n.map(function(e){return e.val}).join(",")}if(e=="name"){return n.map(function(e){return e.name})}if(e=="nameStr"){return n.map(function(e){return e.name}).join(",")}return n}if(f.isArray(e)){var r=ee('[xid="'+i+'"]'),l={},o=void 0,s=true;if(t==false){s=false}else if(t==true){s=true}else{f.removeAll(i)}if(s){a.values.forEach(function(e,t){l[e.val]=1})}e.forEach(function(e,t){if(e&&(!l[e]||a.config.repeat)){if((o=r.find('dd[lay-value="'+e+'"]'))[0]){f.handlerLabel(i,o,s,null,true);l[e]=1}else{var n=f.valToName(i,e);if(n){f.handlerLabel(i,o,s,{name:n,val:e},true);l[e]=1}}}})}};a.prototype.on=function(e,t){f.bindEvent("on",e,t);return this};a.prototype.filter=function(e,t){f.bindEvent("filter",e,t);return this};a.prototype.maxTips=function(e,t){f.bindEvent("maxTips",e,t);return this};a.prototype.config=function(e,n,t){if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=n==true;n=e;e=null}if(n&&(typeof n==="undefined"?"undefined":_typeof(n))=="object"){if(t){n.header||(n.header={});n.header["Content-Type"]="application/json; charset=UTF-8";n.dataType="json"}e?(te[e]=ee.extend(true,{},te[e]||K,n),!f.check(e)&&this.render(e),G[e]&&(G[e].config.direction=n.direction),n.searchUrl&&G[e]&&f.triggerSearch(ee("."+H+' dl[xid="'+e+'"]').parents("."+Q),true)):(ee.extend(true,K,n),ee.each(te,function(e,t){ee.extend(true,t,n)}))}return this};a.prototype.render=function(e,t){var n=this;if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=e;e=null}var i={};e?f.check(e)&&(i[e]=G[e]):i=G;var a=t?{init:t.init,disabled:t.disabled,max:t.max,isSearch:t.isSearch,isCreate:t.isCreate,radio:t.radio,skin:t.skin,direction:t.direction,height:t.height,formname:t.formname,layverify:t.layverify,layverType:t.layverType,searchType:t.searchType,showCount:t.showCount,placeholder:t.placeholder,create:t.create,filter:t.filter,maxTips:t.maxTips,on:t.on,template:t.template}:{};if(Object.getOwnPropertyNames(i).length){ee.each(i,function(e,t){if(f.check(e)){n.value(e,[]);ee.extend(G[e].config,a);f.render(e,t.select)}})}(ee("select["+D+'="'+e+'"]')[0]?ee("select["+D+'="'+e+'"]'):ee("select["+D+"]")).each(function(e,t){var n=t.getAttribute(D);f.render(n,t)});return this};a.prototype.disabled=function(e){var t={};e?f.check(e)&&(t[e]=G[e]):t={};ee.each(t,function(e,t){ee('dl[xid="'+e+'"]').prev().addClass(X)});return this};a.prototype.undisabled=function(e){var t={};e?f.check(e)&&(t[e]=G[e]):t={};ee.each(t,function(e,t){ee('dl[xid="'+e+'"]').prev().removeClass(X)});return this};a.prototype.data=function(e,t,n){if(!e||!t||!n){return this}!f.check(e)&&this.render(e);this.value(e,[]);this.config(e,n);if(t=="local"){f.renderData(e,n.arr,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}else if(t=="server"){f.ajax(e,n.url,n.keyword,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}return this};a.prototype.btns=function(e,o,s){if(!o||!f.isArray(o)){return this}var t={};e?f.check(e)&&(t[e]=G[e]):t={};o=o.map(function(e){if(typeof e=="string"){if(e=="select"){return n[0]}if(e=="remove"){return n[1]}if(e=="reverse"){return n[2]}if(e=="skin"){return n[3]}}return e});ee.each(t,function(e,t){t.config.btns=o;var n=ee('dl[xid="'+e+'"]').find("."+b+":first");if(o.length){var i=s&&s.show&&(s.show=="name"||s.show=="icon")?s.show:"";var a=f.renderBtns(e,i,s&&s.space?s.space:"30px");n.html(a)}else{var r=n.parents("."+Q).find("."+M+" input");var l=r.attr("placeholder")||r.attr("back");n.html(l);n.removeAttr("style")}});return this};a.prototype.search=function(e,t){if(e&&f.check(e)){te[e]=ee.extend(true,{},te[e]||K,{first:true,searchVal:t});f.triggerSearch(ee('dl[xid="'+e+'"]').parents("."+Q),true)}return this};return new a});